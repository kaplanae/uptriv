<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}UpTriv - Daily Brain Training{% endblock %}</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@400;500;600;700&family=Inter:wght@400;500;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>
    <div class="app-container">
        <header>
            <nav>
                <a href="{{ url_for('index') }}" class="logo">
                    <div class="logo-brain">
                        <svg viewBox="0 0 44 46" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <!-- Professional brain side profile logo -->
                            <!-- Frontal lobe - News (coral red) -->
                            <path d="M6 18C5 14 6 9 10 5.5C14 2.5 20 1.5 23 2.2L20 7.5C17 8.5 14.5 11 13 14.5C11.5 17.5 10 19 7.5 19.5C6.5 19 6 18.5 6 18Z" fill="#FF6B6B" stroke="#FF6B6B" stroke-width="0.5"/>
                            <!-- Parietal lobe - History (teal) -->
                            <path d="M23 2.2C28 3 32 5 34.5 9C36 12 36.5 15.5 36 18.5L31 17.5C29 15.5 26 14 23 13.5C20 13 19 11 20 7.5L23 2.2Z" fill="#4ECDC4" stroke="#4ECDC4" stroke-width="0.5"/>
                            <!-- Temporal lobe - Science (blue) -->
                            <path d="M7.5 19.5C10 19 11.5 17.5 13 14.5C14.5 11.5 16.5 10 19.5 10L19.5 16C17.5 17.5 16 20 15.5 23C15 26 14.5 27.5 14.5 29.5C11 28 8 25.5 6.5 22C5.5 19.5 6 19 7.5 19.5Z" fill="#45B7D1" stroke="#45B7D1" stroke-width="0.5"/>
                            <!-- Occipital lobe - Entertainment (green) -->
                            <path d="M36 18.5C36.5 21.5 35 25 32 27.5C30 29.5 27 30 26 29.5L25.5 24.5C27 22.5 29 20 31 17.5L36 18.5Z" fill="#96CEB4" stroke="#96CEB4" stroke-width="0.5"/>
                            <!-- Cerebellum - Sports (yellow) -->
                            <path d="M14.5 29.5C14.5 27.5 15 25 15.5 23C16 20 17.5 17.5 19.5 16L19.5 10C22.5 10 25 11.5 23 13.5C26 14 29 15.5 31 17.5C29 20 27 22.5 25.5 24.5L26 29.5C24 28 20 27.5 17.5 28C15.5 28.5 14.5 29 14.5 29.5Z" fill="#FFEAA7" stroke="#FFEAA7" stroke-width="0.5"/>
                            <!-- Brain stem - Geography (plum) -->
                            <path d="M15.5 29.5C17.5 28.5 20 28 22 28C24 28 25.5 28.5 26 29.5C24 31 23.5 33 24 35L17.5 35C18 33 17.5 31 15.5 29.5Z" fill="#DDA0DD" stroke="#DDA0DD" stroke-width="0.5"/>
                            <!-- Brain folds for texture -->
                            <g stroke="rgba(255,255,255,0.5)" stroke-linecap="round" fill="none" stroke-width="0.8">
                                <path d="M9 7 Q12 5.5, 16 5"/>
                                <path d="M8 10 Q11 8.5, 15 8"/>
                                <path d="M24 4 Q28 4.5, 32 7"/>
                                <path d="M25 7 Q28.5 8, 33 11"/>
                            </g>
                        </svg>
                    </div>
                    <span class="logo-text">UpTriv</span>
                </a>
                <div class="nav-links">
                    <a href="{{ url_for('index') }}">Home</a>
                    <a href="{{ url_for('play') }}">Play</a>
                    <a href="{{ url_for('history') }}">History</a>
                    <a href="{{ url_for('onboarding') }}" id="onboarding-link">Profile Quiz</a>
                    <a href="{{ url_for('friends_page') }}" class="auth-only" style="display:none;">Friends</a>
                    <a href="{{ url_for('leaderboard_page') }}" class="auth-only" style="display:none;">Leaderboard</a>
                </div>
                <div class="auth-section">
                    <div id="auth-loading" class="auth-loading">...</div>
                    <a href="{{ url_for('google_login') }}" id="login-btn" class="auth-btn login-btn" style="display:none;">
                        <svg width="18" height="18" viewBox="0 0 24 24">
                            <path fill="#4285F4" d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"/>
                            <path fill="#34A853" d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"/>
                            <path fill="#FBBC05" d="M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"/>
                            <path fill="#EA4335" d="M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"/>
                        </svg>
                        Sign In
                    </a>
                    <div id="user-menu" class="user-menu" style="display:none;">
                        <img id="user-avatar" class="user-avatar" src="" alt="">
                        <span id="user-name" class="user-name"></span>
                        <a href="{{ url_for('logout') }}" class="logout-btn">Logout</a>
                    </div>
                </div>
            </nav>
        </header>

        <main>
            {% block content %}{% endblock %}
        </main>

        <footer>
            <p>Â© UpTriv</p>
        </footer>
    </div>

    {% block scripts %}{% endblock %}

    <script>
    // Check auth status and update UI
    async function checkAuth() {
        try {
            const res = await fetch('/api/me');
            const data = await res.json();

            document.getElementById('auth-loading').style.display = 'none';

            if (data.authenticated) {
                document.getElementById('login-btn').style.display = 'none';
                document.getElementById('user-menu').style.display = 'flex';
                document.getElementById('user-name').textContent = data.user.username;
                if (data.user.profile_picture) {
                    document.getElementById('user-avatar').src = data.user.profile_picture;
                }
                // Show auth-only links
                document.querySelectorAll('.auth-only').forEach(el => el.style.display = 'inline');
                // Store username for other pages
                localStorage.setItem('uptriv_username', data.user.username);
            } else {
                document.getElementById('login-btn').style.display = 'flex';
                document.getElementById('user-menu').style.display = 'none';
            }
        } catch (e) {
            document.getElementById('auth-loading').style.display = 'none';
            document.getElementById('login-btn').style.display = 'flex';
        }
    }
    checkAuth();
    </script>
</body>
</html>
